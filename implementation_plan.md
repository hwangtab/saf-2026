# 관리자 작가 연락처 다운로드 기능 구현 계획서

## 1) 목표

- 관리자 작가 목록 화면에서 `전체 연락처 다운받기` 버튼으로 전체 작가 연락처/상세 정보를 한 번에 다운로드할 수 있게 한다.
- 전화번호는 하이픈 포함 포맷으로 정규화하며, 전화번호가 없는 행도 빈 값으로 포함한다.
- 작가 신청 시 입력한 소개(`artist_applications.bio`)를 포함해 최대한 많은 정보를 CSV로 제공한다.

## 2) 확정 요구사항

1. 다운로드 범위는 `전체`만 제공한다. (검색 결과/부분 다운로드 제외)
2. 버튼 라벨은 `전체 연락처 다운받기`로 표기한다. (`CSV` 문구 미표기)
3. 버튼 위치는 관리자 작가 목록 헤더의 `작가 등록` 버튼 옆으로 배치한다.
4. 전화번호 없는 행은 제거하지 않고 그대로 포함한다.
5. 전화번호는 하이픈 포함 형식으로 정규화한다.

## 3) 구현 범위

### 포함

- `app/admin/artists/export/route.ts` 신규 추가 (관리자 전용 다운로드 API)
- `lib/utils/phone.ts` 신규 추가 (전화번호 정규화/하이픈 포맷)
- `app/admin/artists/page.tsx`에 `전체 연락처 다운받기` 버튼 추가
- `artists`, `profiles`, `artist_applications` 데이터를 조합해 확장 컬럼 CSV 생성
- 다운로드 실행 시 관리자 활동 로그 기록

### 제외

- 부분 다운로드/필터 다운로드 UI
- 엑셀(xlsx) 파일 포맷 제공
- 문자 발송 기능 자체 구현

## 4) 구현 단계

1. 전화번호 정규화 유틸 구현 (`+82` 변환 포함, 하이픈 포맷 출력)
2. 관리자 권한 검증이 포함된 작가 연락처 export 라우트 구현
3. 작가/계정/신청 정보를 조합한 CSV 컬럼 구성 및 응답 헤더 설정
4. 작가 페이지 헤더 액션 영역에 다운로드 버튼 배치
5. lint/type-check로 정적 검증 수행

## 5) 검증 계획

- 관리자 로그인 상태에서 `/admin/artists/export` 다운로드 성공 확인
- 비관리자/비로그인 접근 시 401/403 확인
- CSV에 전화번호 빈 값 행이 유지되는지 확인
- CSV 전화번호가 하이픈 형식으로 출력되는지 샘플 확인
- `npm run lint`
- `npm run type-check`

## 6) 완료 기준 (Definition of Done)

1. 관리자 작가 페이지에서 `전체 연락처 다운받기` 버튼이 `작가 등록` 옆에 노출된다.
2. 다운로드 파일에 연락처 및 신청 소개를 포함한 확장 데이터가 담긴다.
3. 전화번호 포맷이 하이픈 포함 형식으로 정규화된다.
4. 정적 점검(lint/type-check)이 통과한다.
